<main>
  <!-- Login -->
  <section id="loginSection">
    <form id="loginForm" onsubmit="return login()">
      <h2>Iniciar Sesión</h2>
      <input type="text" id="usuario" placeholder="Usuario" required />
      <input type="password" id="contrasena" placeholder="Contraseña" required />
      <button type="submit">Entrar</button>
      <div id="error"></div>
    </form>
  </section>

  <!-- Biblioteca (oculta al inicio) -->
  <section id="bibliotecaSection" class="hidden">
    <div style="text-align: right; margin-bottom: 1em;">
      <button id="logoutBtn" onclick="cerrarSesion()">Cerrar sesión</button>
    </div>

    <section id="buscador">
      <input type="text" id="searchInput" placeholder="Buscar libros por título o autor..." />
      <button onclick="buscarLibro()">Buscar</button>
    </section>

    <section id="libros">
      <h2>Catálogo de Libros (PDF)</h2>
      <ul id="listaLibros">
        <!-- Libros cargados automáticamente -->
      </ul>
    </section>

    <!-- Visor de PDF -->
    <section id="visorPDF" class="hidden" style="margin-top: 2em;">
      <h3>Visualizando: <span id="nombreLibro"></span></h3>
      <iframe id="pdfFrame" src="" width="100%" height="600px" style="border: 1px solid #ccc;"></iframe>
    </section>
  </section>
</main>

<footer>
  <p>&copy; 2025 Biblioteca Digital. Todos los derechos reservados.</p>
</footer>

<script>
  const USUARIO_VALIDO = "David";
  const CONTRASENA_VALIDA = "1235";

  const libros = [
    {
      titulo: "El arte de la guerra",
      autor: "Sun Tzu",
      archivo: "https://tusitio.com/libros/El_arte_de_la_guerra-Sun_Tzu.pdf"
    },
    {
      titulo: "Historia de la corrupción en el Perú",
      autor: "Alfonso Quiroz",
      archivo: "https://tusitio.com/libros/Historia_de_la_corrupcion_en_el_Peru_Alf.pdf"
    },
    {
      titulo: "Las crónicas de Narnia",
      autor: "C S Lewis",
      archivo: "https://tusitio.com/libros/Las_cronicas_de_Narnia_La_coleccion_completa.pdf"
    }
    // Puedes agregar más libros con URLs públicas aquí
  ];

  function login() {
    const usuario = document.getElementById('usuario').value;
    const contrasena = document.getElementById('contrasena').value;
    const errorDiv = document.getElementById('error');

    if (usuario === USUARIO_VALIDO && contrasena === CONTRASENA_VALIDA) {
      document.getElementById('loginSection').classList.add('hidden');
      document.getElementById('bibliotecaSection').classList.remove('hidden');
      errorDiv.textContent = "";
      mostrarLibros(libros);
    } else {
      errorDiv.textContent = "Usuario o contraseña incorrectos.";
    }

    return false;
  }

  function cerrarSesion() {
    document.getElementById('bibliotecaSection').classList.add('hidden');
    document.getElementById('loginSection').classList.remove('hidden');

    document.getElementById('usuario').value = "";
    document.getElementById('contrasena').value = "";
    document.getElementById('searchInput').value = "";
    document.getElementById('listaLibros').innerHTML = "";
    document.getElementById('error').textContent = "";
    document.getElementById('visorPDF').classList.add('hidden');
    document.getElementById('pdfFrame').src = "";
  }

  function mostrarLibros(lista) {
    const ul = document.getElementById('listaLibros');
    ul.innerHTML = '';

    if (lista.length === 0) {
      ul.innerHTML = '<li>No se encontraron libros.</li>';
      return;
    }

    lista.forEach(libro => {
      const li = document.createElement('li');
      const link = document.createElement('a');
      link.href = "#";
      link.textContent = `${libro.titulo} - ${libro.autor}`;
      link.onclick = function () {
        mostrarPDF(libro.archivo, libro.titulo);
        return false;
      };
      li.appendChild(link);
      ul.appendChild(li);
    });
  }

  function buscarLibro() {
    const texto = document.getElementById('searchInput').value.toLowerCase();
    const filtrados = libros.filter(libro =>
      libro.titulo.toLowerCase().includes(texto) ||
      libro.autor.toLowerCase().includes(texto)
    );
    mostrarLibros(filtrados);
  }

  function mostrarPDF(ruta, titulo) {
    const viewerURL = "https://docs.google.com/gview?embedded=true&url=" + encodeURIComponent(ruta);
    document.getElementById('pdfFrame').src = viewerURL;
    document.getElementById('nombreLibro').textContent = titulo;
    document.getElementById('visorPDF').classList.remove('hidden');
  }
</script>


